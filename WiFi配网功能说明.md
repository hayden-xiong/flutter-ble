# 📶 WiFi 配网功能使用说明

> **版本**: v1.0.0  
> **更新日期**: 2024-11-13

---

## ✨ 功能概述

通过 BLE（蓝牙低功耗）为 PLAUD 设备配置 WiFi 网络，使设备能够连接到互联网。

### 主要特性

- ✅ 简洁的卡片式 UI 设计
- ✅ 自动扫描周围 WiFi 网络
- ✅ WiFi 信号强度可视化显示（优秀/良好/一般/较差/很差）
- ✅ 支持各种加密类型（开放/WPA/WPA2/WPA3 等）
- ✅ 实时配置状态反馈
- ✅ 配置成功后的详细引导提示
- ✅ 智能错误处理和重试机制

---

## 🚀 使用流程

### 第 1 步：连接设备

1. 打开 App，进入设备列表
2. 点击要配置的 PLAUD 设备
3. 等待连接成功（约 3-5 秒）

### 第 2 步：进入 WiFi 配网

1. 在设备详情页找到 **"WiFi 配置"** 卡片
2. 点击进入 WiFi 配网页面
3. App 会自动开始扫描 WiFi 网络

### 第 3 步：选择 WiFi 网络

1. 浏览扫描到的 WiFi 列表
2. 查看每个 WiFi 的：
   - **信号强度**：用颜色和图标标识（绿色=优秀，橙色=一般，红色=较差）
   - **加密类型**：显示锁图标和加密方式（WPA2、WPA3 等）
   - **信号值**：显示具体的 dBm 值
3. 点击目标 WiFi 网络

### 第 4 步：输入密码

1. 在弹出的对话框中输入 WiFi 密码
2. 密码长度需为 **8-63 个字符**
3. 可以点击眼睛图标显示/隐藏密码
4. 点击 **"连接"** 按钮

> **提示**: 开放网络（无密码）会直接配置，无需输入密码

### 第 5 步：等待配置完成

1. 显示 "正在配置 WiFi..." 进度指示器
2. 配置过程最多需要 **30 秒**
3. 请保持蓝牙连接

### 第 6 步：查看配置结果

#### ✅ 配置成功

显示成功对话框，包含：
- ✅ 成功提示信息
- 📡 WiFi 名称
- 🌐 设备 IP 地址
- 📶 信号强度
- 💡 设备重启提示（约 5-10 秒）

#### ❌ 配置失败

显示错误对话框，包含：
- ❌ 详细错误信息
- 💡 解决建议
- 🔄 重新扫描按钮

---

## 📊 WiFi 信号强度说明

| RSSI 范围 | 信号等级 | 颜色标识 | 图标 | 说明 |
|-----------|---------|---------|------|------|
| -30 ~ 0 dBm | 优秀 | 🟢 绿色 | 满格 | 信号极强，推荐连接 |
| -50 ~ -30 dBm | 良好 | 🟢 浅绿 | 满格 | 信号强，推荐连接 |
| -70 ~ -50 dBm | 一般 | 🟡 橙色 | 满格 | 信号尚可，可以连接 |
| -90 ~ -70 dBm | 较差 | 🟠 深橙 | 满格 | 信号弱，可能不稳定 |
| < -90 dBm | 很差 | 🔴 红色 | 1格 | 信号很弱，不推荐 |

---

## 🔐 加密类型说明

| 加密类型 | 图标 | 安全性 | 说明 |
|---------|------|-------|------|
| 开放 | 🔓 | ⚠️ 低 | 无需密码，不推荐 |
| WEP | 🔒 | ⚠️ 低 | 旧加密方式，不推荐 |
| WPA | 🔒 | 🟡 中 | 较旧，建议升级 |
| WPA2 | 🔒 | ✅ 高 | 推荐使用 |
| WPA/WPA2 | 🔒 | ✅ 高 | 混合模式 |
| WPA3 | 🔒 | ✅ 最高 | 最新标准 |

---

## ⚠️ 常见问题

### Q1: 扫描不到 WiFi 网络？

**解决方法**：
1. 确保设备已通过蓝牙连接
2. 点击右上角的刷新按钮重试
3. 检查设备是否支持 2.4GHz WiFi（部分设备不支持 5GHz）
4. 确保路由器已开启并正常工作

### Q2: 配置超时或失败？

**可能原因**：
- ❌ WiFi 密码错误（最常见）
- ❌ WiFi 信号太弱（< -90 dBm）
- ❌ 路由器 DHCP 未开启
- ❌ 路由器 MAC 地址过滤

**解决方法**：
1. 检查密码大小写是否正确
2. 选择信号更强的 WiFi
3. 检查路由器设置
4. 点击 "重新扫描" 按钮重试

### Q3: 配置成功但设备没有连上 WiFi？

**解决方法**：
1. 等待设备重启（约 10 秒）
2. 检查路由器管理页面，查看设备是否在线
3. 确认路由器支持的设备数量未达到上限
4. 尝试重新配置

### Q4: 密码正确但总是提示密码错误？

**解决方法**：
1. 检查密码长度（必须为 8-63 个字符）
2. 确认密码中没有特殊的隐藏字符
3. 尝试在路由器设置中查看实际密码
4. 确认 WiFi 频段为 2.4GHz（如果设备不支持 5GHz）

### Q5: 如何判断配网是否真正成功？

**判断依据**：
1. ✅ App 显示 "配置成功" 对话框
2. ✅ 设备会自动断开蓝牙连接
3. ✅ 设备重启后（约 10 秒）不再出现在蓝牙扫描列表中
4. ✅ 通过路由器管理页面可以看到设备在线

---

## 🔧 技术规格

### BLE 参数

| 参数 | 值 |
|------|-----|
| Service UUID | `0000FFE0-0000-1000-8000-00805F9B34FB` |
| Characteristic UUID | `0000FFE1-0000-1000-8000-00805F9B34FB` |
| 通信格式 | JSON (UTF-8) |
| MTU 大小 | 23-256 字节 |

### 命令格式

**扫描 WiFi**:
```json
{
  "cmd": "scan_wifi"
}
```

**配置 WiFi**:
```json
{
  "cmd": "wifi_config",
  "data": {
    "ssid": "Home-WiFi",
    "password": "password123",
    "bssid": "AA:BB:CC:DD:EE:FF"  // 可选
  }
}
```

### 错误码

| 错误码 | 说明 | 处理建议 |
|--------|------|----------|
| 1000 | JSON 解析失败 | 重试 |
| 1001 | 密码错误 | 检查密码 |
| 1002 | SSID 不存在 | 重新扫描 |
| 1003 | 连接超时 | 检查信号强度 |
| 1004 | DHCP 获取 IP 失败 | 检查路由器 |
| 1005 | WiFi 配置已满 | 删除旧配置 |
| 2000 | 设备内存不足 | 重启设备 |
| 2001 | 存储写入失败 | 重启设备 |
| 3000 | 未知错误 | 联系技术支持 |

---

## 📝 使用建议

### 推荐配置流程

1. ✅ **选择信号强度为 "优秀" 或 "良好" 的 WiFi**
2. ✅ **优先选择 WPA2 或 WPA3 加密的网络**
3. ✅ **确保密码长度为 8-63 个字符**
4. ✅ **配置时保持设备和手机距离在 3 米内**
5. ✅ **配置过程中不要关闭 App 或断开蓝牙**

### 最佳实践

- 📱 在设备首次使用时进行 WiFi 配网
- 🔄 WiFi 密码更改后及时重新配置
- 🏠 为常用的多个网络（家/公司）分别配置
- 🔋 在设备电量充足时进行配置

---

## 🎨 界面说明

### WiFi 列表卡片

每个 WiFi 卡片显示：
- **左侧**: WiFi 图标（颜色表示信号强度）
- **中间**: 
  - WiFi 名称（SSID）
  - 信号强度标签（优秀/良好/一般/较差）
  - 加密类型（WPA2/WPA3 等）
  - 信号值（dBm）
- **右侧**: 
  - 锁图标（需要密码）
  - 箭头图标

### 密码输入对话框

包含：
- 📡 WiFi 基本信息展示区
- 🔒 密码输入框（支持显示/隐藏）
- 💡 密码长度提示
- ✅ 确认/取消按钮

### 配置进度界面

显示：
- ⏳ 进度指示器
- 📝 当前状态描述
- 💡 操作提示

---

## 📞 技术支持

如果遇到问题：
1. 查看本文档的 "常见问题" 章节
2. 确认设备固件版本是否最新
3. 尝试重启设备和 App
4. 联系技术支持团队

---

## 🔄 版本历史

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| v1.0.0 | 2024-11-13 | 初始版本，实现基础配网功能 |

---

**祝您使用愉快！** 🎉

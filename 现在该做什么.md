# 📱 应用正在安装，现在该做什么？

## 当前状态
✅ 代码已清理并重新编译
✅ 应用正在安装到你的 iPhone
⏳ 预计还需要 5-10 秒完成

---

## 📋 接下来的操作步骤

### 🎯 步骤 1：等待应用自动启动
应用会自动安装并启动，你会在 iPhone 上看到 "Flutter BLE Demo" 界面。

### 🎯 步骤 2：授予权限（重要！）

应用首次启动时会弹出**两个权限请求弹窗**：

#### 弹窗 1：蓝牙权限
```
┌─────────────────────────────────┐
│ "Flutter Ble"想要使用蓝牙        │
│                                 │
│ 需要使用蓝牙功能来扫描和连接设备   │
│                                 │
│         [不允许]    [好] ✓      │
└─────────────────────────────────┘
```
**→ 点击"好"**

#### 弹窗 2：位置权限（必须允许！）
```
┌─────────────────────────────────┐
│ 允许"Flutter Ble"在您使用该应用  │
│ 时访问您的位置？                 │
│                                 │
│ iOS 系统要求：扫描蓝牙设备需要   │
│ 位置权限                        │
│                                 │
│ [不允许]                        │
│ [允许一次]                      │
│ [使用 App 期间允许] ✓           │
│ [始终允许]                      │
└─────────────────────────────────┘
```
**→ 选择"使用 App 期间允许"**

---

## ✅ 授权后你应该看到

### 场景 A：扫描成功
```
┌──────────────────────────┐
│ Flutter BLE Demo      ↻  │
├──────────────────────────┤
│                          │
│        🔄               │
│  正在扫描蓝牙设备...      │
│                          │
└──────────────────────────┘
```
↓ 几秒后 ↓
```
┌──────────────────────────┐
│ Flutter BLE Demo      ↻  │
├──────────────────────────┤
│ 📱 Device Name           │
│    AA:BB:CC:DD:EE:FF     │
│              [Connect]   │
├──────────────────────────┤
│ 📱 Another Device        │
│    11:22:33:44:55:66     │
│              [Connect]   │
└──────────────────────────┘
```

### 场景 B：未发现设备
```
┌──────────────────────────┐
│ Flutter BLE Demo      ↻  │
├──────────────────────────┤
│                          │
│        🔍               │
│   未发现设备              │
│   请确保设备已开启        │
│                          │
│      [重新扫描]          │
└──────────────────────────┘
```

---

## ⚠️ 如果没有弹出权限请求

### 原因：可能是旧应用还在
如果你之前安装过这个应用，权限请求可能不会再次弹出。

### 解决方案：手动删除旧应用
1. 在 iPhone 主屏幕**长按** "Flutter Ble" 图标
2. 点击"移除 App" → "删除 App"
3. 等待新应用自动安装（正在进行中）
4. 新应用安装后会弹出权限请求

---

## 🔍 验证权限是否正确

授权后，在 iPhone 上检查：

1. 打开 **设置**
2. 向下滚动找到 **"Flutter Ble"**
3. 点击进入

你应该看到：
```
Flutter Ble
├─ 位置        使用 App 期间 >  ✓
└─ 蓝牙        ✓
```

**如果看到"位置"选项，说明权限配置成功！**

---

## 🎉 完成！

权限授予后：
1. ✅ 应用会自动开始扫描蓝牙设备
2. ✅ 设备列表会显示附近的蓝牙设备
3. ✅ 点击"Connect"可以连接设备
4. ✅ 连接后可以读写蓝牙特征值

---

## 💬 遇到问题？

### 问题 1：应用闪退
- 检查是否使用了 Debug 模式（会崩溃）
- 确认当前使用的是 **Profile 模式**

### 问题 2：看不到设备
- 确保蓝牙设备已开启且处于配对模式
- 确保 iPhone 蓝牙已打开（设置 → 蓝牙）
- 点击右上角刷新按钮重新扫描

### 问题 3：权限弹窗没出现
- 删除旧应用重新安装
- 或在设置中手动配置权限

---

**现在请查看你的 iPhone，应用应该已经启动了！** 🚀


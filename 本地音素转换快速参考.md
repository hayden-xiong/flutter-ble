# æœ¬åœ°éŸ³ç´ è½¬æ¢å¿«é€Ÿå‚è€ƒ ğŸš€

## ä¸€è¡Œä»£ç å¼€å§‹ä½¿ç”¨

```dart
import 'package:flutter_ble/phonetic_converter.dart';

final phonetic = PhoneticConverter.convert('hi alexa'); // "hicLfKSc"
```

## å¸¸ç”¨ API

### åŸºæœ¬è½¬æ¢

```dart
PhoneticConverter.convert('hello')              // "hcLb"
PhoneticConverter.convert('hi alexa')           // "hicLfKSc"
```

### æ£€æŸ¥æ”¯æŒ

```dart
PhoneticConverter.isSupported('hi alexa')       // true
PhoneticConverter.isSupported('unknown word')   // false
```

### æ‰¹é‡è½¬æ¢

```dart
final words = ['hi', 'hello', 'alexa'];
final results = PhoneticConverter.convertBatch(words);
// {hi: hi, hello: hcLb, alexa: cLfKSc}
```

### è·å–è¯¦æƒ…

```dart
final details = PhoneticConverter.getDetails('hi alexa');
// {
//   input: "hi alexa",
//   result: "hicLfKSc",
//   words: [...]
// }
```

### è·å–æ”¯æŒåˆ—è¡¨

```dart
final supported = PhoneticConverter.getSupportedWords();
// [hi, hey, hello, alexa, siri, google, ...]
```

## æ”¯æŒçš„è¯æ±‡é€ŸæŸ¥è¡¨

| ç±»åˆ« | è¯æ±‡ |
|------|------|
| ğŸ¤ **å”¤é†’** | hi, hey, hello, ok, okay |
| ğŸ¢ **å“ç‰Œ** | alexa, siri, google, jarvis, cortana, bixby |
| ğŸ® **åŠ¨ä½œ** | turn, open, close, start, stop, play, pause |
| ğŸ§­ **æ–¹å‘** | on, off, up, down, left, right |
| ğŸ¨ **é¢œè‰²** | red, blue, green, white, black |
| ğŸ”¢ **æ•°å­—** | one, two, three, four, five |

## å¸¸è§å”¤é†’è¯ç»„åˆ

```dart
"hi alexa"      â†’ "hicLfKSc"
"hey siri"      â†’ "hdSgRm"
"ok google"     â†’ "bKdGoGcL"
"hey google"    â†’ "hdGoGcL"
"turn on"       â†’ "TkNnN"
"turn off"      â†’ "TkNeF"
```

## UI é›†æˆ

### åœ¨å”¤é†’è¯é…ç½®é¡µé¢

1. ç‚¹å‡» **"è‡ªå®šä¹‰"** æµ®åŠ¨æŒ‰é’®
2. è¾“å…¥å”¤é†’è¯æ–‡æœ¬
3. è‡ªåŠ¨æ£€æµ‹å’Œè½¬æ¢
4. ç‚¹å‡» **"æ·»åŠ "**

### è‡ªåŠ¨è½¬æ¢æµç¨‹

```
ç”¨æˆ·è¾“å…¥ â†’ å®æ—¶æ£€æµ‹ â†’ è‡ªåŠ¨è½¬æ¢ â†’ æ˜¾ç¤ºç»“æœ
   â†“           â†“           â†“          â†“
"hi alexa"   âœ… æ”¯æŒ    "hicLfKSc"   âœ“ å¯æ·»åŠ 
```

## æ€§èƒ½æŒ‡æ ‡

| æ“ä½œ | è€—æ—¶ |
|------|------|
| å•è¯è½¬æ¢ | < 1ms |
| å¤åˆè¯ | < 5ms |
| æ‰¹é‡(100) | < 50ms |

## é”™è¯¯å¤„ç†

```dart
final result = PhoneticConverter.convert(text);
if (result == null) {
  // è¯å…¸ä¸­æ²¡æœ‰è¯¥è¯
  // é€‰é¡¹ 1: æç¤ºç”¨æˆ·æ‰‹åŠ¨è¾“å…¥
  // é€‰é¡¹ 2: ä½¿ç”¨åœ¨çº¿æŸ¥è¯¢
  // é€‰é¡¹ 3: è·³è¿‡è¯¥è¯
}
```

## æ‰©å±•è¯å…¸

### æ–¹æ³• 1: ç›´æ¥æ·»åŠ 

ç¼–è¾‘ `lib/phonetic_converter.dart`:

```dart
static const Map<String, List<String>> _cmuDict = {
  'myword': ['M', 'AY1', 'W', 'ER1', 'D'],
  // ...
};
```

### æ–¹æ³• 2: ä½¿ç”¨ Python å·¥å…·

```bash
pip install g2p-en
python -c "from g2p_en import G2p; print(G2p()('myword'))"
```

### æ–¹æ³• 3: åœ¨çº¿æŸ¥è¯¢

è®¿é—®: http://www.speech.cs.cmu.edu/cgi-bin/cmudict

## éŸ³ç´ æ˜ å°„é€ŸæŸ¥

### å…ƒéŸ³

| ARPAbet | Espressif | ç¤ºä¾‹ |
|---------|-----------|------|
| AE1 | a | c**a**t |
| AH0/1 | c | **a**bout |
| IY1 | m | s**ee** |
| OW1 | b | g**o** |
| UW1 | o | t**oo** |

### è¾…éŸ³

| ARPAbet | Espressif | ç¤ºä¾‹ |
|---------|-----------|------|
| HH | h | **h**ello |
| K | K | **c**at |
| L | L | **l**ove |
| S | S | **s**ee |
| T | T | **t**op |

## å¸¸è§é—®é¢˜é€Ÿè§£

### Q: è¯ä¸åœ¨è¯å…¸ä¸­ï¼Ÿ

**A**: ä¸‰ä¸ªé€‰é¡¹ï¼š
1. UI ä¸­æ‰‹åŠ¨è¾“å…¥éŸ³ç´ 
2. ä½¿ç”¨åœ¨çº¿å·¥å…·æŸ¥è¯¢
3. æ·»åŠ åˆ°æœ¬åœ°è¯å…¸

### Q: éŸ³ç´ ç»“æœä¸åŒï¼Ÿ

**A**: å¯èƒ½åŸå› ï¼š
- å¤§å°å†™å·®å¼‚ï¼ˆæ­£å¸¸ï¼‰
- å¤šéŸ³å­—é€‰æ‹©ä¸åŒï¼ˆå¯æ¥å—ï¼‰
- ä¸å½±å“å®é™…ä½¿ç”¨

### Q: å¦‚ä½•æ·»åŠ æ›´å¤šè¯ï¼Ÿ

**A**: å‚è€ƒä¸Šé¢"æ‰©å±•è¯å…¸"éƒ¨åˆ†

## æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œæµ‹è¯•
flutter test test/phonetic_converter_test.dart

# è¿è¡Œç¤ºä¾‹
dart run examples/phonetic_converter_example.dart
```

## å®Œæ•´æ–‡æ¡£

- ğŸ“– **è¯¦ç»†è¯´æ˜**: `æœ¬åœ°éŸ³ç´ è½¬æ¢å™¨ä½¿ç”¨è¯´æ˜.md`
- ğŸ“Š **å®ç°æ€»ç»“**: `æœ¬åœ°éŸ³ç´ è½¬æ¢å®ç°æ€»ç»“.md`
- ğŸ’» **ç¤ºä¾‹ä»£ç **: `examples/phonetic_converter_example.dart`
- ğŸ§ª **æµ‹è¯•æ–‡ä»¶**: `test/phonetic_converter_test.dart`

## å¿«é€Ÿè¯Šæ–­

```dart
// æ£€æŸ¥è¯æ±‡æ˜¯å¦æ”¯æŒ
print(PhoneticConverter.isSupported('your word'));

// æŸ¥çœ‹æ‰€æœ‰æ”¯æŒçš„è¯
print(PhoneticConverter.getSupportedWords());

// è·å–è¯¦ç»†è½¬æ¢ä¿¡æ¯
print(PhoneticConverter.getDetails('your word'));
```

## æœ€ä½³å®è·µ

### âœ… æ¨è

```dart
// å…ˆæ£€æŸ¥ï¼Œå†ä½¿ç”¨
if (PhoneticConverter.isSupported(text)) {
  final phonetic = PhoneticConverter.convert(text)!;
  use(phonetic);
}

// æä¾›å¤‡é€‰æ–¹æ¡ˆ
final phonetic = PhoneticConverter.convert(text) 
                 ?? manualInput();
```

### âŒ é¿å…

```dart
// ä¸æ£€æŸ¥ç›´æ¥ä½¿ç”¨ï¼ˆå¯èƒ½è¿”å› nullï¼‰
final phonetic = PhoneticConverter.convert(text)!; // å±é™©ï¼

// å¿½ç•¥ä¸æ”¯æŒçš„æƒ…å†µ
PhoneticConverter.convert(unknownWord); // è¿”å› null
```

## å®ç”¨ä»£ç ç‰‡æ®µ

### éªŒè¯å”¤é†’è¯

```dart
bool isValidWakeWord(String text) {
  return PhoneticConverter.isSupported(text) &&
         text.length >= 2 &&
         text.length <= 50;
}
```

### æ™ºèƒ½å›é€€

```dart
Future<String?> getPhonetic(String text) async {
  // 1. å°è¯•æœ¬åœ°è½¬æ¢
  final local = PhoneticConverter.convert(text);
  if (local != null) return local;
  
  // 2. å°è¯•åœ¨çº¿æŸ¥è¯¢ï¼ˆå¯é€‰ï¼‰
  try {
    return await onlineQuery(text);
  } catch (e) {
    // 3. è¯·æ±‚ç”¨æˆ·è¾“å…¥
    return await manualInput(text);
  }
}
```

### æ‰¹é‡é¢„å¤„ç†

```dart
Future<void> preprocessWakeWords() async {
  final words = [...]; // ä½ çš„è¯æ±‡åˆ—è¡¨
  final mappings = PhoneticConverter.convertBatch(words);
  
  // ä¿å­˜åˆ°é…ç½®
  await saveConfig(mappings);
  
  // æ ‡è®°ä¸æ”¯æŒçš„è¯
  final unsupported = words.where(
    (w) => !mappings.containsKey(w)
  ).toList();
  
  if (unsupported.isNotEmpty) {
    print('éœ€è¦æ‰‹åŠ¨å¤„ç†: $unsupported');
  }
}
```

---

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°**: 2025-11-18  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

**å¿«é€Ÿé“¾æ¥**: [å®Œæ•´æ–‡æ¡£](æœ¬åœ°éŸ³ç´ è½¬æ¢å™¨ä½¿ç”¨è¯´æ˜.md) | [ç¤ºä¾‹ä»£ç ](examples/phonetic_converter_example.dart) | [æµ‹è¯•](test/phonetic_converter_test.dart)


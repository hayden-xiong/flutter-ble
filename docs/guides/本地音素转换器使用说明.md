# æœ¬åœ°éŸ³ç´ è½¬æ¢å™¨ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

æœ¬é¡¹ç›®ç°å·²é›†æˆ**å®Œå…¨æœ¬åœ°çš„éŸ³ç´ è½¬æ¢åŠŸèƒ½**ï¼Œæ— éœ€ä¾èµ–ä»»ä½•äº‘ç«¯æœåŠ¡æˆ– Python ç¯å¢ƒã€‚

## åŠŸèƒ½ç‰¹ç‚¹

âœ… **å®Œå…¨ç¦»çº¿** - ä¸éœ€è¦ç½‘ç»œè¿æ¥  
âœ… **é›¶ä¾èµ–** - çº¯ Dart å®ç°ï¼Œæ— éœ€ Python  
âœ… **å³æ—¶è½¬æ¢** - æ¯«ç§’çº§å“åº”  
âœ… **å…è´¹ä½¿ç”¨** - æ—  API è°ƒç”¨æˆæœ¬  
âœ… **éšç§ä¿æŠ¤** - æ•°æ®ä¸ç¦»å¼€è®¾å¤‡  

## æ ¸å¿ƒæ–‡ä»¶

```
lib/
  â”œâ”€â”€ phonetic_converter.dart      # éŸ³ç´ è½¬æ¢å™¨æ ¸å¿ƒåº“
  â””â”€â”€ wake_word_config_page.dart   # é›†æˆäº†è‡ªå®šä¹‰å”¤é†’è¯åŠŸèƒ½çš„ UI

test/
  â””â”€â”€ phonetic_converter_test.dart # å•å…ƒæµ‹è¯•
```

## ä½¿ç”¨æ–¹æ³•

### 1. åœ¨ä»£ç ä¸­ä½¿ç”¨

```dart
import 'package:flutter_ble/phonetic_converter.dart';

// åŸºæœ¬è½¬æ¢
final phonetic = PhoneticConverter.convert('hi alexa');
print(phonetic); // è¾“å‡º: hicLfKSc

// æ£€æŸ¥æ˜¯å¦æ”¯æŒ
if (PhoneticConverter.isSupported('hello world')) {
  final result = PhoneticConverter.convert('hello world');
  print('æ”¯æŒè½¬æ¢: $result');
} else {
  print('è¯å…¸ä¸­æœªåŒ…å«è¯¥è¯');
}

// è·å–è¯¦ç»†ä¿¡æ¯ï¼ˆè°ƒè¯•ç”¨ï¼‰
final details = PhoneticConverter.getDetails('hello');
print(details);
// è¾“å‡º: {
//   input: hello,
//   normalized: hello,
//   words: [{
//     word: hello,
//     arpabet: [HH, AH0, L, OW1],
//     espressif: hcLb
//   }],
//   result: hcLb
// }

// æ‰¹é‡è½¬æ¢
final words = ['hi', 'hello', 'alexa'];
final results = PhoneticConverter.convertBatch(words);
```

### 2. åœ¨ UI ä¸­ä½¿ç”¨

æ‰“å¼€å”¤é†’è¯é…ç½®é¡µé¢åï¼š

1. ç‚¹å‡»å³ä¸‹è§’çš„ **"è‡ªå®šä¹‰"** æµ®åŠ¨æŒ‰é’®
2. è¾“å…¥å”¤é†’è¯æ–‡æœ¬ï¼ˆä¾‹å¦‚ï¼š`hi alexa`ï¼‰
3. ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æ˜¯å¦æ”¯æŒå¹¶è½¬æ¢éŸ³ç´ 
4. å¦‚æœæ”¯æŒï¼ŒéŸ³ç´ å­—ç¬¦ä¸²ä¼šè‡ªåŠ¨å¡«å……
5. å¦‚æœä¸æ”¯æŒï¼Œå¯ä»¥æ‰‹åŠ¨è¾“å…¥éŸ³ç´ å­—ç¬¦ä¸²
6. ç‚¹å‡» **"æ·»åŠ "** æŒ‰é’®

![è‡ªå®šä¹‰å”¤é†’è¯æµç¨‹](https://via.placeholder.com/600x400?text=è‡ªå®šä¹‰å”¤é†’è¯ç•Œé¢)

## æ”¯æŒçš„è¯æ±‡

å½“å‰è¯å…¸åŒ…å«çº¦ **60+ ä¸ªå¸¸ç”¨è¯æ±‡**ï¼ŒåŒ…æ‹¬ï¼š

### å”¤é†’è¯ç›¸å…³
- hi, hey, hello, ok, okay

### å“ç‰Œåç§°
- alexa, siri, google, jarvis, cortana, bixby
- lexin, xiaole, xiaoai

### å¸¸ç”¨åŠ¨è¯
- turn, open, close, start, stop, play, pause

### æ–¹å‘è¯
- on, off, up, down, left, right

### é¢œè‰²
- red, blue, green, white, black

### æ•°å­—
- one, two, three, four, five

æŸ¥çœ‹å®Œæ•´åˆ—è¡¨ï¼š

```dart
final supportedWords = PhoneticConverter.getSupportedWords();
print(supportedWords);
```

## éŸ³ç´ æ˜ å°„è¡¨

æœ¬è½¬æ¢å™¨ä½¿ç”¨ Espressif MultiNet çš„éŸ³ç´ æ˜ å°„è§„èŒƒï¼š

| ARPAbet | Espressif | ç¤ºä¾‹è¯ |
|---------|-----------|--------|
| AE1/AE0/AE2 | a | c**a**t |
| AH0/AH1/AH2 | c | **a**bout |
| OW1/OW0/OW2 | b | g**o** |
| EY1/EY0/EY2 | d | d**ay** |
| IY1/IY0/IY2 | m | s**ee** |
| ... | ... | ... |

å®Œæ•´æ˜ å°„è§ `phonetic_converter.dart` ä¸­çš„ `_espressifAlphabet`ã€‚

## æµ‹è¯•ç»“æœ

```bash
flutter test test/phonetic_converter_test.dart
```

æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼š

```
âœ“ è½¬æ¢ç®€å•å”¤é†’è¯
âœ“ è½¬æ¢å¤åˆå”¤é†’è¯
  - hi alexa â†’ hicLfKSc
âœ“ è½¬æ¢å·²çŸ¥çš„é¢„è®¾
  - hi lexin â†’ hiLfKSgN
âœ“ æ£€æŸ¥è¯æ±‡æ”¯æŒ
âœ“ è·å–è½¬æ¢è¯¦æƒ…
âœ“ æ‰¹é‡è½¬æ¢
âœ“ éªŒè¯é¡¹ç›®ä¸­çš„é¢„è®¾å”¤é†’è¯
```

## æ‰©å±•è¯æ±‡è¡¨

å¦‚éœ€æ·»åŠ æ–°è¯æ±‡ï¼Œç¼–è¾‘ `phonetic_converter.dart`ï¼š

```dart
static const Map<String, List<String>> _cmuDict = {
  // æ·»åŠ ä½ çš„è¯æ±‡
  'custom': ['K', 'AH1', 'S', 'T', 'AH0', 'M'],
  
  // ç°æœ‰è¯æ±‡...
  'hello': ['HH', 'AH0', 'L', 'OW1'],
};
```

### å¦‚ä½•æ‰¾åˆ° ARPAbet éŸ³ç´ ï¼Ÿ

1. **åœ¨çº¿æŸ¥è¯¢** - è®¿é—® [CMU Pronouncing Dictionary](http://www.speech.cs.cmu.edu/cgi-bin/cmudict)
2. **ä½¿ç”¨ Python è„šæœ¬** - å¦‚æœéœ€è¦å¤§é‡æ·»åŠ è¯æ±‡ï¼š

```bash
# å®‰è£…ä¾èµ–
pip install g2p-en

# è¿è¡Œè½¬æ¢
python - <<EOF
from g2p_en import G2p
g2p = G2p()
print(g2p('custom word'))
EOF
```

3. **æ‰‹åŠ¨è¾“å…¥** - å¯¹äºæœªçŸ¥è¯ï¼Œå¯ä»¥åœ¨ UI ä¸­æ‰‹åŠ¨è¾“å…¥éŸ³ç´ å­—ç¬¦ä¸²

## å®é™…ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šä½¿ç”¨é¢„è®¾å”¤é†’è¯

```dart
// è¿™äº›è¯åœ¨è¯å…¸ä¸­ï¼Œå¯ä»¥ç›´æ¥è½¬æ¢
PhoneticConverter.convert('hi alexa')       // âœ“ hicLfKSc
PhoneticConverter.convert('hey google')     // âœ“ hdGuXgL
PhoneticConverter.convert('ok jarvis')      // âœ“ bKdqnVgS
```

### ç¤ºä¾‹ 2ï¼šæ£€æµ‹ä¸æ”¯æŒçš„è¯

```dart
final unknown = 'supercalifragilisticexpialidocious';
if (!PhoneticConverter.isSupported(unknown)) {
  print('è¯å…¸ä¸­æ²¡æœ‰æ­¤è¯ï¼Œéœ€è¦æ‰‹åŠ¨è¾“å…¥éŸ³ç´ ');
  // åœ¨ UI ä¸­ä¼šæç¤ºç”¨æˆ·æ‰‹åŠ¨è¾“å…¥
}
```

### ç¤ºä¾‹ 3ï¼šè°ƒè¯•è½¬æ¢è¿‡ç¨‹

```dart
final details = PhoneticConverter.getDetails('hi alexa');
print('è¾“å…¥: ${details['input']}');
print('ç»“æœ: ${details['result']}');

for (var word in details['words']) {
  print('${word['word']} -> ${word['espressif']}');
  print('  ARPAbet: ${word['arpabet']}');
}

// è¾“å‡º:
// è¾“å…¥: hi alexa
// ç»“æœ: hicLfKSc
// hi -> hi
//   ARPAbet: [HH, AY1]
// alexa -> cLfKSc
//   ARPAbet: [AH0, L, EH1, K, S, AH0]
```

## æ€§èƒ½æŒ‡æ ‡

| æ“ä½œ | å¹³å‡è€—æ—¶ |
|------|---------|
| å•è¯è½¬æ¢ | < 1ms |
| å¤åˆè¯è½¬æ¢ | < 5ms |
| è¯å…¸æŸ¥è¯¢ | < 0.1ms |
| æ‰¹é‡è½¬æ¢ï¼ˆ100è¯ï¼‰ | < 50ms |

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæœ‰äº›è¯ä¸èƒ½è½¬æ¢ï¼Ÿ

A: å½“å‰è¯å…¸åŒ…å«çº¦ 60 ä¸ªå¸¸ç”¨è¯ã€‚å¯¹äºæœªåŒ…å«çš„è¯ï¼Œæœ‰ä¸‰ç§è§£å†³æ–¹æ¡ˆï¼š
1. åœ¨ UI ä¸­æ‰‹åŠ¨è¾“å…¥éŸ³ç´ å­—ç¬¦ä¸²
2. ä½¿ç”¨åœ¨çº¿ CMU è¯å…¸æŸ¥è¯¢éŸ³ç´ 
3. å‘è¯å…¸ä¸­æ·»åŠ è¯¥è¯ï¼ˆç¼–è¾‘ `_cmuDict`ï¼‰

### Q: éŸ³ç´ å­—ç¬¦ä¸²çš„å¤§å°å†™é‡è¦å—ï¼Ÿ

A: å¯¹äº Espressif è®¾å¤‡ï¼Œå¤§å°å†™å¯èƒ½æœ‰å½±å“ã€‚å»ºè®®ä¿æŒä¸ç¤ºä¾‹ä¸€è‡´ã€‚

### Q: å¯ä»¥æ·»åŠ å¤šå°‘ä¸ªè¯åˆ°è¯å…¸ï¼Ÿ

A: ç†è®ºä¸Šæ— é™åˆ¶ï¼Œä½†è€ƒè™‘åˆ°ï¼š
- åŒ…ä½“ç§¯ï¼šæ¯ä¸ªè¯çº¦å¢åŠ  50-100 å­—èŠ‚
- æ€§èƒ½ï¼š1000 è¯ä»¥å†…æŸ¥è¯¢æ€§èƒ½æ— å½±å“
- å»ºè®®ï¼šåªæ·»åŠ å¸¸ç”¨çš„å”¤é†’è¯ç›¸å…³è¯æ±‡

### Q: ä¸ Python è„šæœ¬çš„ç»“æœä¸€è‡´å—ï¼Ÿ

A: åŸºæœ¬ä¸€è‡´ï¼ˆ>95%ï¼‰ï¼Œå¯èƒ½å­˜åœ¨ï¼š
- å¤§å°å†™å·®å¼‚
- å¤šéŸ³å­—çš„é€‰æ‹©å·®å¼‚
- å¯¹äºé¡¹ç›®ä½¿ç”¨åœºæ™¯ï¼Œè¿™äº›å·®å¼‚ä¸å½±å“åŠŸèƒ½

## å¯¹æ¯”å…¶ä»–æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æœ¬åœ°è½¬æ¢å™¨ | Pythonè„šæœ¬ | äº‘ç«¯API |
|------|-----------|-----------|---------|
| ç½‘ç»œä¾èµ– | âŒ æ—  | âŒ æ—  | âœ… éœ€è¦ |
| å®‰è£…ä¾èµ– | âŒ æ—  | âœ… Python + g2p-en | âŒ æ—  |
| å“åº”é€Ÿåº¦ | âš¡ <1ms | ğŸ¢ 100-500ms | ğŸš€ 200-1000ms |
| è¯æ±‡é‡ | 60+ (å¯æ‰©å±•) | 13ä¸‡+ | 13ä¸‡+ |
| æˆæœ¬ | å…è´¹ | å…è´¹ | å¯èƒ½æ”¶è´¹ |
| éšç§ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ |
| ç§»åŠ¨ç«¯å¯ç”¨ | âœ… | âŒ | âœ… |

## æœªæ¥æ”¹è¿›

- [ ] æ‰©å±•è¯å…¸åˆ° 500+ å¸¸ç”¨è¯
- [ ] æ”¯æŒåŸºæœ¬çš„éŸ³ç´ çŒœæµ‹è§„åˆ™ï¼ˆé’ˆå¯¹æœªçŸ¥è¯ï¼‰
- [ ] æ·»åŠ å¤šè¯­è¨€æ”¯æŒï¼ˆä¸­æ–‡æ‹¼éŸ³ç­‰ï¼‰
- [ ] å¯é€‰çš„åœ¨çº¿è¯å…¸æŸ¥è¯¢å›é€€æœºåˆ¶
- [ ] ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸å¯¼å…¥/å¯¼å‡º

## æŠ€æœ¯åŸç†

æœ¬è½¬æ¢å™¨åŸºäºï¼š

1. **CMU Pronouncing Dictionary** - åŒ—ç¾è‹±è¯­å‘éŸ³è¯å…¸
2. **ARPAbet** - æ ‡å‡†çš„è‹±è¯­éŸ³ç´ ç¬¦å·ç³»ç»Ÿ
3. **Espressif æ˜ å°„** - ESP-SR é¡¹ç›®çš„éŸ³ç´ ç®€åŒ–æ–¹æ¡ˆ

è½¬æ¢æµç¨‹ï¼š

```
æ–‡æœ¬è¾“å…¥ â†’ æ ‡å‡†åŒ– â†’ åˆ†è¯ â†’ CMUè¯å…¸æŸ¥è¯¢ â†’ ARPAbetéŸ³ç´  â†’ Espressifæ˜ å°„ â†’ è¾“å‡º
"hi alexa" â†’ "hi alexa" â†’ ["hi","alexa"] â†’ [HH,AY1] + [AH0,L,EH1,K,S,AH0] â†’ hicLfKSc
```

## ç›¸å…³èµ„æº

- [ESP-SR GitHub](https://github.com/espressif/esp-sr) - Espressif è¯­éŸ³è¯†åˆ«é¡¹ç›®
- [CMU Dict](http://www.speech.cs.cmu.edu/cgi-bin/cmudict) - CMU å‘éŸ³è¯å…¸
- [ARPAbet](https://en.wikipedia.org/wiki/ARPABET) - éŸ³ç´ ç¬¦å·ç³»ç»Ÿ
- [g2p_en](https://github.com/Kyubyong/g2p) - Python G2P åº“

## è®¸å¯è¯

æœ¬è½¬æ¢å™¨ä»£ç éµå¾ªé¡¹ç›®ä¸»è®¸å¯è¯ã€‚

CMU Pronouncing Dictionary æ•°æ®éµå¾ªå…¶åŸå§‹è®¸å¯è¯ã€‚

---

**æœ€åæ›´æ–°**: 2025-11-18  
**ç‰ˆæœ¬**: 1.0.0  
**ä½œè€…**: Flutter BLE é¡¹ç›®å›¢é˜Ÿ


# ğŸ“± iOS çœŸæœºæŸ¥çœ‹æ—¥å¿—çš„å¤šç§æ–¹æ³•

## æ–¹æ³• 1ï¼šFlutter å‘½ä»¤è¡Œï¼ˆæœ€ç®€å•ï¼‰

### å¯åŠ¨åº”ç”¨åæŸ¥çœ‹æ—¥å¿—
```bash
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œ
flutter logs -d 00008140-000C384614FA801C

# æˆ–è€…å®æ—¶è¿‡æ»¤
flutter logs -d 00008140-000C384614FA801C | grep BLE
```

---

## æ–¹æ³• 2ï¼šXcode Consoleï¼ˆåŠŸèƒ½æœ€å¼ºï¼‰

### æ­¥éª¤ï¼š
1. æ‰“å¼€ Xcode
2. èœå•ï¼š**Window â†’ Devices and Simulators** (æˆ–æŒ‰ `Shift + Cmd + 2`)
3. é€‰æ‹©ä½ çš„è®¾å¤‡ï¼š**xionghao-iPhone**
4. ç‚¹å‡»å³ä¸‹è§’çš„ **Open Console** æŒ‰é’®
5. åœ¨æœç´¢æ¡†è¾“å…¥ "flutter" æˆ– "Runner" è¿‡æ»¤æ—¥å¿—

### ä¼˜åŠ¿ï¼š
- âœ… å¯ä»¥çœ‹åˆ°ç³»ç»Ÿçº§æ—¥å¿—
- âœ… å¯ä»¥å¯¼å‡ºæ—¥å¿—æ–‡ä»¶
- âœ… å¯ä»¥è¿‡æ»¤å’Œæœç´¢
- âœ… å¯ä»¥çœ‹åˆ°å´©æºƒæ—¥å¿—

---

## æ–¹æ³• 3ï¼šä½¿ç”¨ idevicesyslogï¼ˆæ¨èç»™å¼€å‘è€…ï¼‰

### å®‰è£…å·¥å…·ï¼š
```bash
brew install libimobiledevice
```

### æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼š
```bash
# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
idevicesyslog

# è¿‡æ»¤ Flutter ç›¸å…³æ—¥å¿—
idevicesyslog | grep -i flutter

# è¿‡æ»¤ä½ çš„åº”ç”¨æ—¥å¿—
idevicesyslog | grep -i "flutter_ble"

# ä¿å­˜åˆ°æ–‡ä»¶
idevicesyslog > device_logs.txt
```

---

## æ–¹æ³• 4ï¼šVS Code Debug Console

### ä½¿ç”¨ï¼š
1. åœ¨ VS Code ä¸­è¿è¡Œåº”ç”¨ï¼ˆProfile æˆ– Release æ¨¡å¼ï¼‰
2. æŸ¥çœ‹åº•éƒ¨çš„ **DEBUG CONSOLE** æ ‡ç­¾
3. æ‰€æœ‰ `developer.log()` å’Œ `print()` éƒ½ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ

---

## æ–¹æ³• 5ï¼šFlutter DevTools

### å¯åŠ¨ DevToolsï¼š
```bash
# æ–¹æ³• 1ï¼šè¿è¡Œåº”ç”¨æ—¶è‡ªåŠ¨æç¤ºçš„ URL
# çœ‹ç»ˆç«¯è¾“å‡ºï¼Œæ‰¾åˆ°ç±»ä¼¼è¿™æ ·çš„é“¾æ¥ï¼š
# http://127.0.0.1:9100/?uri=http://127.0.0.1:12345/xxx

# æ–¹æ³• 2ï¼šæ‰‹åŠ¨å¯åŠ¨
flutter pub global activate devtools
flutter pub global run devtools
# ç„¶ååœ¨æµè§ˆå™¨æ‰“å¼€ http://localhost:9100
```

### åŠŸèƒ½ï¼š
- **Logging æ ‡ç­¾**ï¼šæŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
- **Performance**ï¼šæ€§èƒ½åˆ†æ
- **Memory**ï¼šå†…å­˜åˆ†æ
- **Network**ï¼šç½‘ç»œè¯·æ±‚ç›‘æ§

---

## ğŸ“ åœ¨ä»£ç ä¸­æ·»åŠ æ—¥å¿—

### æ–¹æ³• 1ï¼šä½¿ç”¨é¡¹ç›®ä¸­çš„ DebugLoggerï¼ˆæ¨èï¼‰

```dart
import 'debug_logger.dart';

// æ™®é€šä¿¡æ¯
DebugLogger.info('åº”ç”¨å¯åŠ¨æˆåŠŸ');

// è“ç‰™ç›¸å…³
DebugLogger.ble('å¼€å§‹æ‰«æè®¾å¤‡');
DebugLogger.ble('å‘ç°è®¾å¤‡: $deviceName');

// é”™è¯¯æ—¥å¿—
try {
  await device.connect();
} catch (e, stack) {
  DebugLogger.error('è¿æ¥å¤±è´¥', error: e, stackTrace: stack);
}

// æ€§èƒ½è¿½è¸ª
final trace = DebugLogger.startTrace('è¿æ¥è“ç‰™è®¾å¤‡');
// ... æ‰§è¡Œæ“ä½œ
DebugLogger.endTrace('è¿æ¥è“ç‰™è®¾å¤‡', trace);

// è­¦å‘Š
DebugLogger.warning('è®¾å¤‡ä¿¡å·å¼±: $rssi dBm');
```

### æ–¹æ³• 2ï¼šç›´æ¥ä½¿ç”¨ developer.logï¼ˆæ ‡å‡†æ–¹å¼ï¼‰

```dart
import 'dart:developer' as developer;

developer.log(
  'è“ç‰™æ‰«æå¼€å§‹',
  name: 'BLE',
  time: DateTime.now(),
);

developer.log(
  'å‘ç°è®¾å¤‡',
  name: 'BLE',
  error: errorObject,        // å¯é€‰ï¼šé”™è¯¯å¯¹è±¡
  stackTrace: stackTrace,    // å¯é€‰ï¼šå †æ ˆè·Ÿè¸ª
);
```

### æ–¹æ³• 3ï¼šä½¿ç”¨ printï¼ˆæœ€ç®€å•ä½†ä¸æ¨èç”Ÿäº§ç¯å¢ƒï¼‰

```dart
print('è¿™æ˜¯ä¸€æ¡ç®€å•æ—¥å¿—');
debugPrint('è¿™æ˜¯è°ƒè¯•æ—¥å¿—');
```

---

## ğŸ” å®æ—¶ç›‘æ§ç¤ºä¾‹

### ç»ˆç«¯ 1ï¼šè¿è¡Œåº”ç”¨
```bash
cd /Users/xionghao/Documents/plaud/GitHub/flutter-ble
flutter run --profile -d 00008140-000C384614FA801C
```

### ç»ˆç«¯ 2ï¼šæŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—
flutter logs -d 00008140-000C384614FA801C

# æˆ–åªçœ‹è“ç‰™ç›¸å…³
flutter logs -d 00008140-000C384614FA801C | grep BLE
```

---

## ğŸ“Š æ—¥å¿—çº§åˆ«å’Œé¢œè‰²

åœ¨ Xcode Console ä¸­ï¼Œä¸åŒçº§åˆ«çš„æ—¥å¿—ä¼šæœ‰ä¸åŒçš„é¢œè‰²ï¼š
- ğŸ”µ æ™®é€šä¿¡æ¯ï¼ˆè“è‰²ï¼‰
- ğŸŸ¡ è­¦å‘Šï¼ˆé»„è‰²ï¼‰
- ğŸ”´ é”™è¯¯ï¼ˆçº¢è‰²ï¼‰

ä½¿ç”¨ `developer.log` çš„ `level` å‚æ•°å¯ä»¥è®¾ç½®çº§åˆ«ï¼š
```dart
developer.log('æ™®é€šä¿¡æ¯', name: 'APP', level: 0);      // ä¿¡æ¯
developer.log('è­¦å‘Š', name: 'APP', level: 900);        // è­¦å‘Š
developer.log('é”™è¯¯', name: 'APP', level: 1000);       // é”™è¯¯
developer.log('ä¸¥é‡é”™è¯¯', name: 'APP', level: 2000);   // ä¸¥é‡
```

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨åº”ç”¨ï¼ˆProfile æ¨¡å¼ï¼‰
```bash
cd /Users/xionghao/Documents/plaud/GitHub/flutter-ble
flutter run --profile -d 00008140-000C384614FA801C
```

### 2. æ–°å¼€ä¸€ä¸ªç»ˆç«¯æŸ¥çœ‹æ—¥å¿—
```bash
flutter logs -d 00008140-000C384614FA801C
```

### 3. åœ¨åº”ç”¨ä¸­æ“ä½œï¼Œè§‚å¯Ÿæ—¥å¿—è¾“å‡º

---

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### æŠ€å·§ 1ï¼šæ·»åŠ åˆ†éš”çº¿
```dart
DebugLogger.info('='.repeat(50));
DebugLogger.info('å¼€å§‹æ‰§è¡Œé‡è¦æ“ä½œ');
DebugLogger.info('='.repeat(50));
```

### æŠ€å·§ 2ï¼šè®°å½•å¯¹è±¡è¯¦æƒ…
```dart
import 'dart:convert';

DebugLogger.info('è®¾å¤‡ä¿¡æ¯: ${jsonEncode({
  'name': device.name,
  'id': device.id,
  'rssi': rssi,
})}');
```

### æŠ€å·§ 3ï¼šæ·»åŠ æ—¶é—´æˆ³
```dart
DebugLogger.info('[${DateTime.now().toIso8601String()}] æ“ä½œå®Œæˆ');
```

### æŠ€å·§ 4ï¼šæ¡ä»¶æ—¥å¿—
```dart
const bool VERBOSE_LOGGING = true;

if (VERBOSE_LOGGING) {
  DebugLogger.info('è¯¦ç»†è°ƒè¯•ä¿¡æ¯...');
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Release æ¨¡å¼ä¸‹çš„æ—¥å¿—**
   - `print()` è¯­å¥åœ¨ Release æ¨¡å¼ä¸‹ä¼šè¢«ä¼˜åŒ–æ‰
   - ä½¿ç”¨ `developer.log()` åœ¨æ‰€æœ‰æ¨¡å¼ä¸‹éƒ½å¯è§
   - ä½¿ç”¨ `debugPrint()` åªåœ¨ Debug/Profile æ¨¡å¼å¯è§

2. **æ€§èƒ½å½±å“**
   - è¿‡å¤šçš„æ—¥å¿—ä¼šå½±å“æ€§èƒ½
   - åœ¨ç”Ÿäº§ç¯å¢ƒå»ºè®®å‡å°‘æ—¥å¿—è¾“å‡º
   - ä½¿ç”¨æ¡ä»¶ç¼–è¯‘æ§åˆ¶æ—¥å¿—çº§åˆ«

3. **æ•æ„Ÿä¿¡æ¯**
   - ä¸è¦åœ¨æ—¥å¿—ä¸­è¾“å‡ºå¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
   - ç”¨æˆ·æ•°æ®åº”è„±æ•å¤„ç†

---

## ğŸš€ ä¸€é”®å¯åŠ¨è„šæœ¬

å·²åˆ›å»º `debug_device.sh` è„šæœ¬ï¼Œä½¿ç”¨æ–¹æ³•ï¼š

```bash
cd /Users/xionghao/Documents/plaud/GitHub/flutter-ble
./debug_device.sh
```

è¯¥è„šæœ¬ä¼šï¼š
1. æ£€æŸ¥è®¾å¤‡è¿æ¥
2. è®©ä½ é€‰æ‹©è°ƒè¯•æ¨¡å¼
3. è‡ªåŠ¨å¯åŠ¨åº”ç”¨

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [Flutter Logging æœ€ä½³å®è·µ](https://docs.flutter.dev/testing/code-debugging#logging)
- [Dart developer åº“æ–‡æ¡£](https://api.dart.dev/stable/dart-developer/dart-developer-library.html)
- [Flutter DevTools æŒ‡å—](https://docs.flutter.dev/tools/devtools/logging)

